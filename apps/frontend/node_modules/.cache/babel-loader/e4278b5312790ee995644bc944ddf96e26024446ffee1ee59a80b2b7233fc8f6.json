{"ast":null,"code":"import React,{createContext,useContext,useEffect,useState}from'react';import{io}from'socket.io-client';import{jsx as _jsx}from\"react/jsx-runtime\";const SocketContext=/*#__PURE__*/createContext(undefined);export const SocketProvider=_ref=>{let{children}=_ref;const[socket,setSocket]=useState(null);const[isConnected,setIsConnected]=useState(false);useEffect(()=>{// Initialize socket connection\nconst newSocket=io(process.env.REACT_APP_API_URL||'http://localhost:3001',{transports:['websocket','polling'],timeout:20000,forceNew:true});newSocket.on('connect',()=>{console.log('Socket connected:',newSocket.id);setIsConnected(true);});newSocket.on('disconnect',()=>{console.log('Socket disconnected');setIsConnected(false);});newSocket.on('connect_error',error=>{console.error('Socket connection error:',error);setIsConnected(false);});setSocket(newSocket);// Cleanup on unmount\nreturn()=>{newSocket.close();};},[]);const joinRoleRoom=role=>{if(socket){socket.emit('join-role',role);}};const leaveRoleRoom=role=>{if(socket){socket.emit('leave-role',role);}};const emitQuizSubmitted=data=>{if(socket){socket.emit('quiz-submitted',data);}};const emitGameCompleted=data=>{if(socket){socket.emit('game-completed',data);}};const emitPolicyAcknowledged=data=>{if(socket){socket.emit('policy-acknowledged',data);}};const onQuizUpdate=callback=>{if(socket){socket.on('quiz-update',callback);}};const onGameUpdate=callback=>{if(socket){socket.on('game-update',callback);}};const onPolicyUpdate=callback=>{if(socket){socket.on('policy-update',callback);}};const value={socket,isConnected,joinRoleRoom,leaveRoleRoom,emitQuizSubmitted,emitGameCompleted,emitPolicyAcknowledged,onQuizUpdate,onGameUpdate,onPolicyUpdate};return/*#__PURE__*/_jsx(SocketContext.Provider,{value:value,children:children});};export const useSocket=()=>{const context=useContext(SocketContext);if(context===undefined){throw new Error('useSocket must be used within a SocketProvider');}return context;};export default SocketContext;","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","io","jsx","_jsx","SocketContext","undefined","SocketProvider","_ref","children","socket","setSocket","isConnected","setIsConnected","newSocket","process","env","REACT_APP_API_URL","transports","timeout","forceNew","on","console","log","id","error","close","joinRoleRoom","role","emit","leaveRoleRoom","emitQuizSubmitted","data","emitGameCompleted","emitPolicyAcknowledged","onQuizUpdate","callback","onGameUpdate","onPolicyUpdate","value","Provider","useSocket","context","Error"],"sources":["C:/Users/seniy/Downloads/project (1)/project/apps/frontend/src/contexts/SocketContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState, ReactNode } from 'react';\r\nimport { io, Socket } from 'socket.io-client';\r\n\r\ninterface SocketContextType {\r\n  socket: Socket | null;\r\n  isConnected: boolean;\r\n  joinRoleRoom: (role: string) => void;\r\n  leaveRoleRoom: (role: string) => void;\r\n  emitQuizSubmitted: (data: any) => void;\r\n  emitGameCompleted: (data: any) => void;\r\n  emitPolicyAcknowledged: (data: any) => void;\r\n  onQuizUpdate: (callback: (data: any) => void) => void;\r\n  onGameUpdate: (callback: (data: any) => void) => void;\r\n  onPolicyUpdate: (callback: (data: any) => void) => void;\r\n}\r\n\r\nconst SocketContext = createContext<SocketContextType | undefined>(undefined);\r\n\r\ninterface SocketProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport const SocketProvider: React.FC<SocketProviderProps> = ({ children }) => {\r\n  const [socket, setSocket] = useState<Socket | null>(null);\r\n  const [isConnected, setIsConnected] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // Initialize socket connection\r\n    const newSocket = io(process.env.REACT_APP_API_URL || 'http://localhost:3001', {\r\n      transports: ['websocket', 'polling'],\r\n      timeout: 20000,\r\n      forceNew: true\r\n    });\r\n\r\n    newSocket.on('connect', () => {\r\n      console.log('Socket connected:', newSocket.id);\r\n      setIsConnected(true);\r\n    });\r\n\r\n    newSocket.on('disconnect', () => {\r\n      console.log('Socket disconnected');\r\n      setIsConnected(false);\r\n    });\r\n\r\n    newSocket.on('connect_error', (error) => {\r\n      console.error('Socket connection error:', error);\r\n      setIsConnected(false);\r\n    });\r\n\r\n    setSocket(newSocket);\r\n\r\n    // Cleanup on unmount\r\n    return () => {\r\n      newSocket.close();\r\n    };\r\n  }, []);\r\n\r\n  const joinRoleRoom = (role: string): void => {\r\n    if (socket) {\r\n      socket.emit('join-role', role);\r\n    }\r\n  };\r\n\r\n  const leaveRoleRoom = (role: string): void => {\r\n    if (socket) {\r\n      socket.emit('leave-role', role);\r\n    }\r\n  };\r\n\r\n  const emitQuizSubmitted = (data: any): void => {\r\n    if (socket) {\r\n      socket.emit('quiz-submitted', data);\r\n    }\r\n  };\r\n\r\n  const emitGameCompleted = (data: any): void => {\r\n    if (socket) {\r\n      socket.emit('game-completed', data);\r\n    }\r\n  };\r\n\r\n  const emitPolicyAcknowledged = (data: any): void => {\r\n    if (socket) {\r\n      socket.emit('policy-acknowledged', data);\r\n    }\r\n  };\r\n\r\n  const onQuizUpdate = (callback: (data: any) => void): void => {\r\n    if (socket) {\r\n      socket.on('quiz-update', callback);\r\n    }\r\n  };\r\n\r\n  const onGameUpdate = (callback: (data: any) => void): void => {\r\n    if (socket) {\r\n      socket.on('game-update', callback);\r\n    }\r\n  };\r\n\r\n  const onPolicyUpdate = (callback: (data: any) => void): void => {\r\n    if (socket) {\r\n      socket.on('policy-update', callback);\r\n    }\r\n  };\r\n\r\n  const value: SocketContextType = {\r\n    socket,\r\n    isConnected,\r\n    joinRoleRoom,\r\n    leaveRoleRoom,\r\n    emitQuizSubmitted,\r\n    emitGameCompleted,\r\n    emitPolicyAcknowledged,\r\n    onQuizUpdate,\r\n    onGameUpdate,\r\n    onPolicyUpdate\r\n  };\r\n\r\n  return (\r\n    <SocketContext.Provider value={value}>\r\n      {children}\r\n    </SocketContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useSocket = (): SocketContextType => {\r\n  const context = useContext(SocketContext);\r\n  if (context === undefined) {\r\n    throw new Error('useSocket must be used within a SocketProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nexport default SocketContext;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}